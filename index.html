<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Kill 'Em All</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.2/socket.io.js"></script>
        <script src="https://unpkg.com/vue/dist/vue.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.4.3/pixi.min.js"></script>
        <style>
            body,
            html {
                width: 100%; height: 100%;
                margin: 0; padding: 0;
                overflow: hidden;
                background-color: #F7F7F7;
            }
            canvas { position: relative; }
        </style>
    </head>
    <body>
        <div id="app"></div>

        <script>
            var socket = io.connect(),
                tweetText, pix,
                width = window.innerWidth,
                height = window.innerHeight;

            // get tweet from server side socket to vue app
            socket.on('tweet', function(data) {
                app.tweet = data.text;
            });

            var app = new Vue({
                el: '#app',
                data: {
                    tweet: 'Please wait for the first tweet to load',
                },
                methods: {
                    // pixi setup
                    createPixi: function() {
                        pix = new PIXI.Application(width, height, {
                            'transparent': true,
                            'autoResize': true,
                            'antialias': true
                        });
                        document.body.appendChild(pix.view);

                        // tweet text style
                        var tweetTex_style = new PIXI.TextStyle({
                            fontFamily: 'Roboto',
                            fontSize: 20,
                            fill: '#453AE4',
                            wordWrap: true,
                            wordWrapWidth: width / 4
                        });

                        // initial text value (placeholder)
                        tweetText = new PIXI.Text(this.tweet, tweetTex_style);

                        // initial text value (placeholder) position: center
                        tweetText.x = (width - tweetText.width) / 2; // horizontally center
                        tweetText.y = (height - tweetText.height) / 2; // vertically center

                        // add twit to stage
                        pix.stage.addChild(tweetText);
                    }
                },
                watch: {
                    // when data.tweet changes
                    'tweet': function(value) {
                        // tweetText update
                        tweetText.text = (this.tweet).toUpperCase();
                        tweetText.style.fontSize = Math.floor(Math.random() * 20) + 9;
                    },
                },
                mounted: function() {
                    // create pixi cavas
                    this.createPixi();
                }
            });
        </script>
    </body>
</html>
